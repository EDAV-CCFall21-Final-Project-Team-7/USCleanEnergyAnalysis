--- 
title: "U.S. Clean Energy Industry Analysis"
author: "Raihan Bashir, Gabrielle Nyirjesy, Abhimanyu Swaroop"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
---
--- 
title: "U.S. Clean Energy Industry Analysis"
author: "Raihan Bashir, Gabrielle Nyirjesy, Abhimanyu Swaroop"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
---
```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```

# Introduction


<!--chapter:end:index.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Data sources


<!--chapter:end:02-data.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Data transformation

Correcting Date format in Financial Data
```{r}
library(tidyr)

Crushing_crude_oil <-read_csv('data/raw/Cushing_OK_WTI_Spot_Price_FOB.csv')
nchar(str_split(Crushing_crude_oil$Day[1],"/",simplify=TRUE)[3])

i<-0
for(val in Crushing_crude_oil$Day){
  i<-i+1
  if(nchar(str_split(Crushing_crude_oil$Day[i],"/",simplify=TRUE)[3]) == 2){
    temp = paste(str_split(Crushing_crude_oil$Day[i],"/",simplify=TRUE)[1],
                 str_split(Crushing_crude_oil$Day[i],"/",simplify=TRUE)[2],
                 sep = "/")
    temp2 = paste("20",
                  str_split(Crushing_crude_oil$Day[i],"/",simplify=TRUE)[3],
                  sep="")
    Crushing_crude_oil$Day[i]<-paste(temp,temp2,sep="/")
  }
}
write.csv(Crushing_crude_oil,'data/raw/clean_crushing_crude_oil.csv',
          row.names=FALSE)
Crushing_crude_oil
```



<!--chapter:end:03-cleaning.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Missing values

```{r, message = F, echo = F}
library(bookdown)
library(tidyverse)
```

## U.S. Energy Information Administration Data
### Missing State/Fuel Type Power Generation
The EIA.gov dataset was the only dataset with missing values that we used in our analysis. Most of the missing values were absent because most states did not generate electricity for all fuel types. This missing data can show which fuel types are most widely adopted by all U.S. states and which fuel types are less common. 
![state-fuel type missing patterns]('state-fuel type missing patterns.png')

### Missing aggregation values

<!--chapter:end:04-missing.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Results

<!--chapter:end:05-results.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Interactive component



<!--chapter:end:06-interactive.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Conclusion


<!--chapter:end:07-conclusion.Rmd-->




<!--chapter:end:eia_data_anlaysis.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
```{r, include = FALSE}
library(tidyverse)

```

```{r, include = FALSE}
#https://www.eia.gov/electricity/data/browser/#/topic/0?freq=M&start=200101&end=202108&ctype=linechart&ltype=pin&pin=&maptype=0
df <- read.csv('data/raw/monthly_fuel_generation_by_state_full.csv')
df$fuel <- trimws(df$fuel) 
df$date <- as.Date(df$date)
df[is.na(df$thousand_megawatthours),]$thousand_megawatthours <- 0
df$fuel <- gsub(" ", "_", df$fuel)
df$fuel <- gsub("-", "_", df$fuel)
```

```{r, fig.height = 10, fig.width = 10}
test2 <- df %>% group_by(state, fuel) %>% summarize(total_thousand_mwh = sum(thousand_megawatthours)) %>% pivot_wider(id_cols = c(state), names_from= fuel, values_from = total_thousand_mwh)
test2
test3 <- test2
test3$state <- NULL
find_missing_patterns(test3, 'percent')
```

<!--chapter:end:Untitled.Rmd-->

